
{% include 'header.html' %}

          <div class="col-12 page-heading">
            <div class="page-title-box d-sm-flex align-items-center justify-content-between">
              <h4 class="mb-sm-0">Product List</h4>
              <div class="page-title-right">
                <ol class="breadcrumb m-0">
                  <li class="breadcrumb-item">
                    <a href="{% url 'dashboard' %}">Dashboard</a>
                  </li>
                  <li class="breadcrumb-item active">Product List</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
        <div class="card product-details card-bgchange">
          <div class="card-header align-items-center d-flex">
            <h4 class="card-title mb-0 flex-grow-1">Product List</h4>
            <button type="button" data-toggle="modal" data-target="#addproduct" class="btn btn-primary bttn-editcode ">
               <a href="#">Add New Product</a><i class="fal fa-plus"></i></button>
          </div>
          <div class="card-body">
            {% if message %}
            <table class="table table-hover dt-responsive" id="productList">
              <thead>
                <tr>
                  <th style="display:none">#</th>
                  <th>Name</th>
                  <th>Price</th>
                  <th>Days of Duration</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
              {% for client in message %}
                  {% if client.user_id == user.id %}
                <tr>
                  <td style="display:none">{{ forloop.counter0 }}</td>
                  <td>{{ client.name }} <span class="product-decr">
                      <small>( {{ client.description }} )</small>
                    </span>
                  </td>
                  <td>â‚¹ {{ client.price }}</td>
                  <td>{{ client.duration }}</td>
                  <td>
                    <div class="btn-group btn-group-sm">
                      <button type="button" data-toggle="modal" data-target="#edit" class="btn btn-sm btn-success" onclick="product({{client.id}})">
                        <i class="fal fa-edit"></i>
                      </button>
                      <button type="button" data-toggle="modal" data-target="#delete" class="btn btn-sm btn-danger" onclick="test({{client.id}})">
                        <i class="fa fa-trash" ></i>
                      </button>
                    </div>
                  </td>
                </tr>
                  {% endif %}
                  {% endfor %}
<!--                <tr>-->
<!--                  <td>2</td>-->
<!--                  <td>2 Lakhs Mail <span class="product-decr">-->
<!--                      <small>( Giving information on its origins as well as a random )</small>-->
<!--                    </span>-->
<!--                  </td>-->
<!--                  <td>20,000 rs</td>-->
<!--                  <td>100 Days</td>-->
<!--                  <td>-->
<!--                    <div class="btn-group btn-group-sm">-->
<!--                      <button type="button" data-toggle="modal" data-target="#edit" class="btn btn-sm btn-success">-->
<!--                        <i class="fal fa-edit"></i>-->
<!--                      </button>-->
<!--                      <button type="button" class="btn btn-sm btn-danger delete-msg">-->
<!--                        <i class="fa fa-trash"></i>-->
<!--                      </button>-->
<!--                    </div>-->
<!--                  </td>-->
<!--                </tr>-->
              </tbody>
            </table>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add modal start here -->
<div class="modal" id="addproduct">
  <div class="modal-dialog edit-contentdetal">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Add Product Details</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <div class="row">

          <form action="/add_product/{{user.id}}" method="post">
            {% csrf_token %}
            <div class="form-group">
              <label>Product Name </label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-shopping-bag"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Name" name="name">
              </div>
            </div>
            <div class="form-group">
              <label>Quantity </label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-shopping-bag"></i>
                </span>
                <input type="number" class="form-control" placeholder="Enter Quantity" name="quantity">
              </div>
            </div>
            <div class="form-group">
              <label>Product Price</label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-money-bill-alt"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Price" name="price">
              </div>
            </div>
            <div class="form-group">
              <label>Product Duration</label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-hourglass-half"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Duration" name="duration">
              </div>
            </div>
            <div class="form-group">
              <label>Product Description</label>
              <textarea class="form-control" name="description" rows="3"></textarea>
            </div>
            <button type="submit" class="btn btn-primary bttn-editcode swalDefaultSuccess">Save <i class="fal fa-arrow-to-right"></i>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Edit modal start here -->
<div class="modal" id="edit">
  <div class="modal-dialog edit-contentdetal">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Edit Product Details</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="row">
          <form action="/update_product" method="post">
            {% csrf_token %}
            <div class="form-group">
              <label>Product Name </label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-shopping-bag"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Name" name="name" id="name">
              </div>
            </div>
            <div class="form-group">
              <label>Quantity </label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-shopping-bag"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Quantity" name="quantity" id="quantity">
              </div>
            </div>
            <div class="form-group">
              <label>Product Price</label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-money-bill-alt"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Price" name="price" id="price">
              </div>
            </div>
            <input id="idname" name="idname" style="display:none">
            <input id="userid" name="userid" style="display:none">
            <div class="form-group">
              <label>Product Duration</label>
              <div class="icontext-style">
                <span class="icon-group-addon">
                  <i class="far fa-hourglass-half"></i>
                </span>
                <input type="text" class="form-control" placeholder="Enter Duration" name="duration" id="duration">
              </div>
            </div>
            <div class="form-group">
              <label>Product Description</label>
              <textarea class="form-control" name="description" id="description" rows="3"></textarea>
            </div>
            <button type="submit" onclick="" class="btn btn-primary bttn-editcode swalDefaultSuccess">Update<i class="fal fa-arrow-to-right"></i>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>


{% include 'footer.html' %}
      <!-- JAVASCRIPT -->
      <script type="text/javascript">
         // datatable init. start//
          $(function () {
            $("#productList").DataTable({
              "responsive": false, "lengthChange": true, "autoWidth": false,"scrollX": true,
            })
          });
         // datatable init. start//
</script>

<script>
  $(function() {
    var Toast = Swal.mixin({
      toast: true,
      position: 'top-end',
      showConfirmButton: false,
      timer: 3000
    });

    $('.swalDefaultSuccess').click(function() {
      Toast.fire({
        icon: 'success',
        title: ' The information was successfully updated.'
      })
    });
    $('.swalDefaultInfo').click(function() {
      Toast.fire({
        icon: 'info',
        title: 'Admin information successfully updated.'
      })
    });
    $('.swalDefaultError').click(function() {
      Toast.fire({
        icon: 'error',
        title: 'Lorem ipsum dolor sit amet, consetetur sadipscing elitr.'
      })
    });
    $('.swalDefaultWarning').click(function() {
      Toast.fire({
        icon: 'warning',
        title: 'Lorem ipsum dolor sit amet, consetetur sadipscing elitr.'
      })
    });
    $('.swalDefaultQuestion').click(function() {
      Toast.fire({
        icon: 'question',
        title: 'Lorem ipsum dolor sit amet, consetetur sadipscing elitr.'
      })
    });

$('.delete-msg').click(function (){
    Swal.fire({
  title: 'Are you sure?',
  text: "You won't be able to revert this!",
  icon: 'warning',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Yes, delete it!'


}).then((result) => {
  if (result.isConfirmed) {
    // Swal.fire(
    //   'Deleted!',
    //   'Your file has been deleted.',
    //   'success'
    // )
  }
})
});
});
</script>
<script>
  function product(val)
      {
        var t = val
        {% for client in message %}
                x = '{{client.id}}';
                if (x == t){
                    document.getElementById("name").value="{{client.name}}";
                    document.getElementById("quantity").value="{{client.quantity}}";
                    document.getElementById("price").value="{{client.price}}";
                    document.getElementById("duration").value="{{client.duration}}";
                    document.getElementById("description").value="{{client.description}}";
                    document.getElementById("idname").value="{{client.id}}";
                    document.getElementById("userid").value="{{user.id}}";
                }
          {% endfor %}
      }
  function test(val)
    {
      var t = val
      console.log(typeof t)
      Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
              console.log("Deleted")
              $.ajax({
                type: "GET",
                url: "{% url 'product_delete' %}" ,
                data:{"value":t},
                });
              window.location.replace('/productlist');
            }
          });
       }

</script>
</html>

